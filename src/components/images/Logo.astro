---
/**
 * Logo - FIXED pattern for logos (header, footer, partner logos)
 * Use: Brand logos, partner logos, any fixed-size logo
 * Pattern: 1x + 2x density srcset using getImage()
 */
import { getImage } from 'astro:assets';
import type { ImageMetadata } from 'astro';

interface Props {
  src: ImageMetadata;
  alt: string;
  width: number;
  height?: number;
  class?: string;
  priority?: boolean;
}

const { src, alt, width, height, class: className, priority = false } = Astro.props;

// FIXED pattern: 1x at quality 80, 2x at quality 60
// WebP with JPEG fallback
const image1xWebp = await getImage({
  src,
  width,
  height,
  quality: 80,
  format: 'webp'
});

const image2xWebp = await getImage({
  src,
  width: width * 2,
  height: height ? height * 2 : undefined,
  quality: 60,
  format: 'webp'
});

const image1xJpeg = await getImage({
  src,
  width,
  height,
  quality: 80,
  format: 'jpeg'
});

const finalHeight = height || width;
---

<picture>
  <source
    srcset={`${image1xWebp.src} 1x, ${image2xWebp.src} 2x`}
    type="image/webp"
  />
  <img
    src={image1xJpeg.src}
    alt={alt}
    width={width}
    height={finalHeight}
    class={className}
    loading={priority ? 'eager' : 'lazy'}
    decoding={priority ? undefined : 'async'}
  />
</picture>
